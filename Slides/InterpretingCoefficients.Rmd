---
title: "6: Interpreting coefficients. Multiple regression."
subtitle: "Linear Models"
author: "<large>Jaye Seawright</large>"
institute: "<small>Northwestern Political Science</small>" 
date: "Jan. 26, 2026"
output: 
  xaringan::moon_reader:
    css: xaringan-themer.css
  
---
class: center, middle

```{css, echo=FALSE}
pre {
  max-height: 400px;
  overflow-y: auto;
}

pre[class] {
  max-height: 200px;
}
```

```{r, load_refs, include=FALSE, cache=FALSE}
# Initializes
library(RefManageR)

library(ggplot2)
library(dplyr)
library(readr)
library(nlme)
library(jtools)
library(mice)
library(knitr)
library(modelsummary)
library(kableExtra)
library(stringr)

BibOptions(check.entries = FALSE,
           bib.style = "authoryear", # Bibliography style
           max.names = 3, # Max author names displayed in bibliography
           sorting = "nyt", #Name, year, title sorting
           cite.style = "authoryear", # citation style
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)

```
```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer,MnSymbol)
style_mono_accent(
  base_color = "#1c5253",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono"),
  text_font_size = "1.6rem"
)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE)

library(readr)

usterrorism <- read_csv("https://raw.githubusercontent.com/jnseawright/ps405/refs/heads/main/Data/usterrorism.csv")

election2016 <- read_csv("https://raw.githubusercontent.com/jnseawright/ps405/refs/heads/main/Data/election2016.csv")

stateattacklist <- table(usterrorism$provstate[usterrorism$iyear>2015])

election2016$Stateterrorism <- 0

for (i in 1:nrow(election2016)){
    if (election2016$State[i] %in% names(stateattacklist))
        election2016$Stateterrorism[i] <- stateattacklist[election2016$State[i] ==names(stateattacklist)]
}

election2016$TrumpShare <- as.numeric(str_replace(election2016$TrumpShare, "%", ""))

election2016$D12Margin <- as.numeric(str_replace(election2016$D12Margin, "%", ""))

library(plotly)
library(dplyr)


blp.multivariate <- lm(Stateterrorism ~ TrumpShare + D12Margin, data = election2016)


trump_range <- seq(min(election2016$TrumpShare, na.rm = TRUE), 
                   max(election2016$TrumpShare, na.rm = TRUE), length.out = 20)
margin_range <- seq(min(election2016$D12Margin, na.rm = TRUE), 
                    max(election2016$D12Margin, na.rm = TRUE), length.out = 20)

grid <- expand.grid(TrumpShare = trump_range, D12Margin = margin_range)
grid$Stateterrorism <- predict(blp.multivariate, newdata = grid)


p <- plot_ly() %>%
    
    add_trace(data = election2016, 
              x = ~TrumpShare, y = ~D12Margin, z = ~Stateterrorism,
              type = 'scatter3d', mode = 'markers',
              marker = list(size = 5, color = 'blue', opacity = 0.7),
              name = 'Actual Data') %>%
   
    add_trace(data = grid,
              x = ~TrumpShare, y = ~D12Margin, z = ~Stateterrorism,
              type = 'mesh3d', 
              opacity = 0.5, color = 'orange',
              name = 'Regression Plane') %>%
    layout(scene = list(
        xaxis = list(title = 'Trump Vote Share'),
        yaxis = list(title = '2012 Margin'),
        zaxis = list(title = 'State Terrorism Incidents'),
        camera = list(eye = list(x = 1.5, y = 1.5, z = 1.5))
    ),
    title = 'Multivariate Regression: Terrorism ~ TrumpShare + D12Margin')


```

Suppose we have a best linear predictor of a CEF. What do the $a$ and $b$ numbers mean?

---

```{r, echo = FALSE, eval=TRUE, out.width="70%", fig.retina = 1, fig.align='center'}
ggplot(election2016, aes(x=TrumpShare, y=Stateterrorism)) + 
     geom_point() + xlab("Trump State Vote Share 2016") + ylab("Terrorism Incidents in State Since 2016") + geom_smooth(method="lm", se=FALSE)
```

---

Let's imagine that our sample approximation of the BLP is exactly right. 

---

```{r, echo = TRUE, eval=TRUE, out.width="70%", fig.retina = 1, fig.align='center'}
blp.lm <- lm(Stateterrorism ~ TrumpShare, data=election2016)
blp.lm
```

---

What does it mean that $a = 17.6841$ and $b = -0.2111$?

---

$$E(y|x_{i}) = a + b x_{i}$$

$$a + b x_{i} = E(y|x_{i})$$

$$a = E(y|x_{i}) - b x_{i}$$

Let $x_{i} = 0$. Then:

$$a = E(y|x_{i})$$.

---

So we would expect to see an average of 17.6841 in states where Trump got no votes.

---

$$E(y|x_{i}) = a + b x_{i}$$

Suppose that $x_{j} = x_{i} + 1$. What is $E(y|x_{j}) - E(y|x_{i})$?

---

$$E(y|x_{j}) - E(y|x_{i}) = (a + b x_{j}) - (a + b x_{i})$$
$$E(y|x_{j}) - E(y|x_{i}) = a + b x_{j} - a - b x_{i}$$
$$E(y|x_{j}) - E(y|x_{i}) = b x_{j} - b x_{i}$$
$$E(y|x_{j}) - E(y|x_{i}) = b (x_{j} - x_{i})$$
$$E(y|x_{j}) - E(y|x_{i}) = b (1)$$
$$E(y|x_{j}) - E(y|x_{i}) = b$$

---

So if there was a cluster of states where Trump got 49 percent of the vote, and another cluster of states where Trump got 50 percent of the vote, we would expect that second cluster to average 0.2111 fewer terrorist attacks since 2015 compared to the first cluster.

---

How does this change if we add a control variable?

---

$$E(y|x_{1,i}, x_{2,i}) = a + b_{1} x_{1,i} + b_{2} x_{2,i}$$

---

Nothing really changes about $a$.

---

Let's treat $x_{2}$ as a control variable and $x_{1}$ as the variable of interest.

Suppose that $x_{1,j} = x_{1,i} + 1$. What is $E(y|x_{1,j},x_{2}) - E(y|x_{i},x_{2})$?

---

$$E(y|x_{j}) - E(y|x_{i}) = (a + b_{1} x_{1,j} + b_{2} x_{2}) - (a + b_{1} x_{1,i} + b_{2}x_{2})$$
$$E(y|x_{j}) - E(y|x_{i}) = a + b_{1} x_{1,j} + b_{2} x_{2} - a - b_{1} x_{1,i} - b_{2}x_{2}$$
$$E(y|x_{j}) - E(y|x_{i}) = b_{1} x_{1,j} - b_{1} x_{1,i}$$
$$E(y|x_{j}) - E(y|x_{i}) = b_{1} (x_{1,j} - x_{1,i})$$
$$E(y|x_{j}) - E(y|x_{i}) = b_{1} (1)$$
$$E(y|x_{j}) - E(y|x_{i}) = b_{1}$$

---

```{r, echo = FALSE, eval=TRUE, out.width="90%", fig.retina = 1, fig.align='center'}
p
```

---

```{r, echo = TRUE, eval=TRUE, out.width="70%", fig.retina = 1, fig.align='center'}
blp.multivariate <- lm(Stateterrorism ~ TrumpShare + D12Margin, data=election2016)
blp.multivariate
```